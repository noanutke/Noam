
results_file = 'VAS_values.xlsx'
results_file_sheet_name = 'Sheet1'
import socket
import time
import pandas
TCP_IP = "192.168.0.1"
TCP_PORT = 20121

pain_machine_connected = False

cmds = {"35": bytearray([9, 0, 0, 0, 185, 223, 16, 88, 1, 22, 0, 0, 0]),  # 42 --> 22
        "35.5": bytearray([9, 0, 0, 0, 72, 166, 15, 88, 1, 19, 0, 0, 0]),  # 43 --> 19
        "36": bytearray([9, 0, 0, 0, 175, 166, 15, 88, 1, 20, 0, 0, 0]),  # 44 --> 20
        "36.5": bytearray([9, 0, 0, 0, 58, 239, 194, 87, 1, 16, 0, 0, 0]),  # 45 --> 16
        "37": bytearray([9, 0, 0, 0, 223, 164, 15, 88, 1, 18, 0, 0, 0]),  # 46 --> 18
        "37.5": bytearray([9, 0, 0, 0, 32, 239, 194, 87, 1, 17, 0, 0, 0]),  # 47 --> 17
        "38": bytearray([9, 0, 0, 0, 17, 167, 15, 88, 1, 21, 0, 0, 0]),  # 48 --> 21
        "38.5": bytearray([9, 0, 0, 0, 52, 49, 72, 88, 1, 23, 0, 0, 0]),  # 49 --> 23
        "39": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 24, 0, 0, 0]),  # 42v4 --> 24
        "39.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 25, 0, 0, 0]),  # 43v4 --> 25
        "40": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 26, 0, 0, 0]),  # 44v4 --> 26
        "40.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 27, 0, 0, 0]),  # 45v4 --> 27
        "41": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 28, 0, 0, 0]),  # 46v4 --> 28
        "41.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 29, 0, 0, 0]),  # 47v4 --> 29
        "42": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 30, 0, 0, 0]),  # 48v4 --> 30
        "42.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 31, 0, 0, 0]),  # 49v4 --> 31
        "43": bytearray([9, 0, 0, 0, 185, 223, 16, 88, 1, 32, 0, 0, 0]),  # 42.5 --> 32 --> 100000
        "43.5": bytearray([9, 0, 0, 0, 72, 166, 15, 88, 1, 33, 0, 0, 0]),  # 43.5 --> 33 --> 100001 pain2
        "44": bytearray([9, 0, 0, 0, 175, 166, 15, 88, 1, 34, 0, 0, 0]),  # 44.5 --> 34 --> 100010
        "44.5": bytearray([9, 0, 0, 0, 58, 239, 194, 87, 1, 35, 0, 0, 0]),  # 45.5 --> 35 --> 100011
        "45": bytearray([9, 0, 0, 0, 223, 164, 15, 88, 1, 36, 0, 0, 0]),  # 46.5 --> 36 --> 100100
        "45.5": bytearray([9, 0, 0, 0, 32, 239, 194, 87, 1, 37, 0, 0, 0]),  # 47.5 --> 37 --> 100101
        "46": bytearray([9, 0, 0, 0, 17, 167, 15, 88, 1, 38, 0, 0, 0]),  # 48.5 --> 38 --> 100110
        "46.5": bytearray([9, 0, 0, 0, 52, 49, 72, 88, 1, 39, 0, 0, 0]),  # 49.5 --> 39 --> 100111
        "47": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 40, 0, 0, 0]),  # 42.5v4 --> 40 --> 101000
        "47.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 41, 0, 0, 0]),  # 43.5v4 --> 41 --> 101001 pain8
        "48": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 42, 0, 0, 0]),  # 44.5v4 --> 42 --> 101010
        "48.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 43, 0, 0, 0]),  # 45.5v4 --> 43 --> 101011
        "49": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 44, 0, 0, 0]),  # 46.5v4 --> 44 --> 101100
        "49.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 45, 0, 0, 0]),  # 47.5v4 --> 45 --> 101101
        "50": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 46, 0, 0, 0]),  # 48.5v4 --> 46 --> 101110
        "50.5": bytearray([9, 0, 0, 0, 196, 52, 72, 88, 1, 47, 0, 0, 0]),  # 49.5v4 --> 47 --> 101111

        "start": bytearray([5, 0, 0, 0, 216, 237, 194, 87, 2]),
        "pause": bytearray([5, 0, 0, 0, 40, 238, 194, 87, 3]),
        "trigger": bytearray([5, 0, 0, 0, 74, 238, 194, 87, 4]),
        "stop": bytearray([5, 0, 0, 0, 157, 238, 194, 87, 5]),
        "abort": bytearray([5, 0, 0, 0, 177, 238, 194, 87, 6]),
        "yes": bytearray([5, 0, 0, 0, 195, 238, 194, 87, 7]),
        "no": bytearray([5, 0, 0, 0, 216, 238, 194, 87, 8])}

def readTmpFromFile(columnName):
    xl = pandas.ExcelFile("VAS_values.xlsx")
    df = xl.parse("Sheet1")
    return df.iloc[0][columnName]

def initSocket():

    global TCP_IPa
    global TCP_PORT
    global s
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((TCP_IP, TCP_PORT))
    return s

def initPain(tmp_input, read_from_file = True):
    tmp = tmp_input
    if read_from_file:
        tmp = readTmpFromFile(tmp_input)
    initSocket()
    global s
    s.send(cmds[tmp])
    a=initSocket()
    time.sleep(2)
    a=s.send(cmds["start"])